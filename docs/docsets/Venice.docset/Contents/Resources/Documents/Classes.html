<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Classes  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset='utf-8'>
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
  </head>
  <body>
    <a title="Classes  Reference"></a>
    <header>
      <div class="content-wrapper">
        <p><a href="index.html">Venice Docs</a> (100% documented)</p>
        <p class="header-right"><a href="https://github.com/Formbound/Venice"><img src="img/gh.png"/>View on GitHub</a></p>
      </div>
    </header>
    <div class="content-wrapper">
      <p id="breadcrumbs">
        <a href="index.html">Venice Reference</a>
        <img id="carat" src="img/carat.png" />
        Classes  Reference
      </p>
    </div>
    <div class="content-wrapper">
      <nav class="sidebar">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a href="Classes.html">Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Classes/Channel.html">Channel</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ChannelSequence.html">ChannelSequence</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/Coroutine.html">Coroutine</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/CoroutineGroup.html">CoroutineGroup</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/Handle.html">Handle</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ReceivingChannel.html">ReceivingChannel</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SendingChannel.html">SendingChannel</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Enums.html">Enums</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Enums/ChannelResult.html">ChannelResult</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/PollEvent.html">PollEvent</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/VeniceError.html">VeniceError</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Extensions.html">Extensions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Extensions/Deadline.html">Deadline</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/Int.html">Int</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Functions.html">Functions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Functions.html#/s:F6Venice5cleanFVs5Int32T_">clean(_:)</a>
              </li>
              <li class="nav-group-task">
                <a href="Functions.html#/s:F6Venice3nowFT_Vs5Int64">now()</a>
              </li>
              <li class="nav-group-task">
                <a href="Functions.html#/s:F6Venice4pollFzTVs5Int325eventOS_9PollEvent8deadlineVs5Int64_T_">poll(_:event:deadline:)</a>
              </li>
              <li class="nav-group-task">
                <a href="Functions.html#/s:F6Venice6wakeUpFzVs5Int64T_">wakeUp(_:)</a>
              </li>
              <li class="nav-group-task">
                <a href="Functions.html#/s:F6Venice5yieldFzT_T_">yield()</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Protocols.html">Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Protocols/TimeIntervalRepresentable.html">TimeIntervalRepresentable</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Typealiases.html">Typealiases</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Typealiases.html#/s:6Venice8Deadline">Deadline</a>
              </li>
              <li class="nav-group-task">
                <a href="Typealiases.html#/s:6Venice14FileDescriptor">FileDescriptor</a>
              </li>
              <li class="nav-group-task">
                <a href="Typealiases.html#/s:6Venice12TimeInterval">TimeInterval</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">
        <section>
          <section class="section">
            <h1>Classes</h1>
            <p>The following classes are available globally.</p>

          </section>
          <section class="section task-group-section">
            <div class="task-group">
              <ul>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:C6Venice7Channel"></a>
                    <a name="//apple_ref/swift/Class/Channel" class="dashAnchor"></a>
                    <a class="token" href="#/s:C6Venice7Channel">Channel</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>A channel is a synchronization primitive.</p>

<p><a href='#threads' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h1 id='threads'>Threads</h1></p>

<p>You can use Venice in multi-threaded programs.
However, individual threads are strictly separated.
You may think of each thread as a separate process.</p>

<p>In particular, a coroutine created in a thread will
be executed in that same thread, and it will never
migrate to a different one.</p>

<p>In a similar manner, a handle, such as a channel or
a coroutine handle, created in one thread cannot be
used in a different thread.</p>

<p><a href='#example' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='example'>Example:</h2>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">channel</span> <span class="o">=</span> <span class="kt">Channel</span><span class="o">&lt;</span><span class="kt">Int</span><span class="o">&gt;</span><span class="p">()</span></p>

<p><span class="k">let</span> <span class="nv">coroutine</span> <span class="o">=</span> <span class="k">try</span> <span class="kt">Coroutine</span> <span class="p">{</span>
    <span class="k">try</span> <span class="n">channel</span><span class="o">.</span><span class="nf">send</span><span class="p">(</span><span class="mi">42</span><span class="p">,</span> <span class="nv">deadline</span><span class="p">:</span> <span class="mi">1</span><span class="o">.</span><span class="n">second</span><span class="o">.</span><span class="nf">fromNow</span><span class="p">())</span>
<span class="p">}</span></p>

<p><span class="k">let</span> <span class="nv">theAnswer</span> <span class="o">=</span> <span class="k">try</span> <span class="n">channel</span><span class="o">.</span><span class="nf">receive</span><span class="p">(</span><span class="nv">deadline</span><span class="p">:</span> <span class="mi">1</span><span class="o">.</span><span class="n">second</span><span class="o">.</span><span class="nf">fromNow</span><span class="p">())</span>
<span class="k">try</span> <span class="n">coroutine</span><span class="o">.</span><span class="nf">close</span><span class="p">()</span>
</code></pre></p>

                        <a href="Classes/Channel.html" class="slightly-smaller">See more</a>
                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight"><code><span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="kt">Channel</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;</span> <span class="p">:</span> <span class="kt"><a href="Classes/Handle.html">Handle</a></span></code></pre>

                        </div>
                      </div>
                    </section>
                  </div>
                </li>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:C6Venice14SendingChannel"></a>
                    <a name="//apple_ref/swift/Class/SendingChannel" class="dashAnchor"></a>
                    <a class="token" href="#/s:C6Venice14SendingChannel">SendingChannel</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>Reference to a channel which can only send.</p>

                        <a href="Classes/SendingChannel.html" class="slightly-smaller">See more</a>
                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight"><code><span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="kt">SendingChannel</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;</span> <span class="p">:</span> <span class="kt"><a href="Classes/Handle.html">Handle</a></span></code></pre>

                        </div>
                      </div>
                    </section>
                  </div>
                </li>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:C6Venice16ReceivingChannel"></a>
                    <a name="//apple_ref/swift/Class/ReceivingChannel" class="dashAnchor"></a>
                    <a class="token" href="#/s:C6Venice16ReceivingChannel">ReceivingChannel</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>Reference to a channel which can only receive.</p>

                        <a href="Classes/ReceivingChannel.html" class="slightly-smaller">See more</a>
                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight"><code><span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="kt">ReceivingChannel</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;</span> <span class="p">:</span> <span class="kt"><a href="Classes/Handle.html">Handle</a></span></code></pre>

                        </div>
                      </div>
                    </section>
                  </div>
                </li>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:C6Venice15ChannelSequence"></a>
                    <a name="//apple_ref/swift/Class/ChannelSequence" class="dashAnchor"></a>
                    <a class="token" href="#/s:C6Venice15ChannelSequence">ChannelSequence</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>Sequence which can be used to receive from a channel in a loop</p>

                        <a href="Classes/ChannelSequence.html" class="slightly-smaller">See more</a>
                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight"><code><span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="kt">ChannelSequence</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;</span> <span class="p">:</span> <span class="kt">Sequence</span><span class="p">,</span> <span class="kt">IteratorProtocol</span></code></pre>

                        </div>
                      </div>
                    </section>
                  </div>
                </li>
              </ul>
            </div>
            <div class="task-group">
              <ul>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:C6Venice9Coroutine"></a>
                    <a name="//apple_ref/swift/Class/Coroutine" class="dashAnchor"></a>
                    <a class="token" href="#/s:C6Venice9Coroutine">Coroutine</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>Lightweight coroutine.</p>

<p>Launching coroutines and switching between them is extremely fast.
It requires only a few machine instructions.
This makes coroutines a suitable basic flow control mechanism,
like the <code>if</code> or <code>while</code> keywords, which have comparable performance.</p>

<p>Coroutines have one big limitation, though: All coroutines run on a single
CPU core. If you want to take advantage of multiple cores, you have to launch
multiple threads or processes, presumably as many of them as there are CPU cores
on your machine.</p>

<p>Coroutines are scheduled cooperatively. What that means is that a coroutine has to
explicitly yield control of the CPU to allow a different coroutine to run.
In a typical scenario, this is done transparently to the user: When a coroutine
invokes a function that would block (such as <code>wakeUp</code>, <code>poll</code> or <code>channel.send</code>),
the CPU is automatically yielded.
However, if a coroutine runs without calling any blocking functions, it may hold
the CPU forever. For these cases, the <code>yield</code> function can be used to manually relinquish
the CPU to other coroutines manually.</p>

<p><a href='#structured-concurrency' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h1 id='structured-concurrency'>Structured Concurrency</h1></p>

<p>Structured concurrency means that lifetimes of concurrent functions are cleanly nested.
If coroutine foo launches coroutine bar, then bar must finish before foo finishes.</p>

<p>This is not structured concurrency:</p>

<p><img src="http://libdill.org/index1.jpeg" alt="not-structured-concurrency" title="Not Structured Concurrency"></p>

<p>This is structured concurrency:</p>

<p><img src="http://libdill.org/index2.jpeg" alt="structured-concurrency" title="Structured Concurrency"></p>

<p>The goal of structured concurrency is to guarantee encapsulation.
If the <code>main</code> function calls <code>foo</code>, which in turn launches <code>bar</code> in a concurrent
fashion, <code>main</code> will be guaranteed that once <code>foo</code> has finished, there will be
no leftover functions still running in the background.</p>

<p>What you end up with is a tree of coroutines rooted in the <code>main</code> function.
This tree spreads out towards the smallest worker functions, and you may
think of this as a generalization of the call stack — a call tree, if you will.
In it, you can walk from any particular function towards the root until you
reach the main function:</p>

<p><img src="http://libdill.org/index3.jpeg" alt="call-tree" title="Call Tree"></p>

<p>Venice implements structured concurrency by allowing you to cancel
a running coroutine.</p>

<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">coroutine</span> <span class="o">=</span> <span class="k">try</span> <span class="kt">Coroutine</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">resource</span> <span class="o">=</span> <span class="nf">malloc</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>

    <span class="k">defer</span> <span class="p">{</span>
        <span class="nf">free</span><span class="p">(</span><span class="n">resource</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="k">while</span> <span class="kc">true</span> <span class="p">{</span>
        <span class="k">try</span> <span class="nf">wakeUp</span><span class="p">(</span><span class="mi">100</span><span class="o">.</span><span class="n">milliseconds</span><span class="o">.</span><span class="nf">fromNow</span><span class="p">())</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"."</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">try</span> <span class="nf">wakeUp</span><span class="p">(</span><span class="mi">1</span><span class="o">.</span><span class="n">second</span><span class="o">.</span><span class="nf">fromNow</span><span class="p">())</span>
<span class="k">try</span> <span class="n">coroutine</span><span class="o">.</span><span class="nf">cancel</span><span class="p">()</span>
</code></pre>

<p>When a coroutine is being canceled all blocking calls will start 
to throw <code><a href="Enums/VeniceError.html#/s:FO6Venice11VeniceError17canceledCoroutineFMS0_S0_">VeniceError.canceledCoroutine</a></code>. On one hand, this forces
the function to finish quickly (there&rsquo;s not much you can do without
blocking functions); on the other hand, it provides an opportunity
for cleanup.</p>

<p>In the example above, when <code>coroutine.cancel</code> is called the call to
<code>wakeUp</code> inside the coroutine will throw <code><a href="Enums/VeniceError.html#/s:FO6Venice11VeniceError17canceledCoroutineFMS0_S0_">VeniceError.canceledCoroutine</a></code>
and then the <code>defer</code> statement will run, thus releasing the memory allocated
for <code>resource</code>.</p>

<p><a href='#threads' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h1 id='threads'>Threads</h1></p>

<p>You can use Venice in multi-threaded programs.
However, individual threads are strictly separated.
You may think of each thread as a separate process.</p>

<p>In particular, a coroutine created in a thread will
be executed in that same thread, and it will never
migrate to a different one.</p>

<p>In a similar manner, a handle, such as a channel or
a coroutine handle, created in one thread cannot be
used in a different thread.</p>

                        <a href="Classes/Coroutine.html" class="slightly-smaller">See more</a>
                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="kt">Coroutine</span> <span class="p">:</span> <span class="kt"><a href="Classes/Handle.html">Handle</a></span></code></pre>

                        </div>
                      </div>
                    </section>
                  </div>
                </li>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:C6Venice14CoroutineGroup"></a>
                    <a name="//apple_ref/swift/Class/CoroutineGroup" class="dashAnchor"></a>
                    <a class="token" href="#/s:C6Venice14CoroutineGroup">CoroutineGroup</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>Coroutine group.</p>

<p>Coroutine groups are useful for canceling multiple coroutines at the
same time.</p>

<p><a href='#example' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='example'>Example:</h2>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">group</span> <span class="o">=</span> <span class="kt">CoroutineGroup</span><span class="p">(</span><span class="nv">minimumCapacity</span><span class="p">:</span> <span class="mi">2</span><span class="p">)</span></p>

<p><span class="k">try</span> <span class="n">group</span><span class="o">.</span><span class="n">addCoroutine</span> <span class="p">{</span>
    <span class="o">...</span>
<span class="p">}</span></p>

<p><span class="k">try</span> <span class="n">group</span><span class="o">.</span><span class="n">addCoroutine</span> <span class="p">{</span>
    <span class="o">...</span>
<span class="p">}</span></p>

<p><span class="c1">// all coroutines in the group will be canceled</span>
<span class="k">try</span> <span class="n">group</span><span class="o">.</span><span class="nf">cancel</span><span class="p">()</span>
</code></pre></p>

                        <a href="Classes/CoroutineGroup.html" class="slightly-smaller">See more</a>
                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="kt">CoroutineGroup</span></code></pre>

                        </div>
                      </div>
                    </section>
                  </div>
                </li>
              </ul>
            </div>
            <div class="task-group">
              <ul>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:C6Venice6Handle"></a>
                    <a name="//apple_ref/swift/Class/Handle" class="dashAnchor"></a>
                    <a class="token" href="#/s:C6Venice6Handle">Handle</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>Representation of a Venice resource</p>

                        <a href="Classes/Handle.html" class="slightly-smaller">See more</a>
                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="kt">Handle</span> <span class="p">:</span> <span class="kt">Hashable</span></code></pre>

                        </div>
                      </div>
                    </section>
                  </div>
                </li>
              </ul>
            </div>
          </section>
        </section>
        <section id="footer">
          <p>&copy; 2017 <a class="link" href="http://zewo.io" target="_blank" rel="external">Zewo</a>. All rights reserved. (Last updated: 2017-03-21)</p>
          <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.7.4</a>, a <a class="link" href="http://realm.io" target="_blank" rel="external">Realm</a> project.</p>
        </section>
      </article>
    </div>
  </body>
</div>
</html>
